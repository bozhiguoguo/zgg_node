{{> head}}
<link rel="stylesheet" href="/css/basicInfo.css" >
<link rel="stylesheet" href="/css/confimProduct.css">
<link rel="stylesheet" href="/css/my_coupon.css" >
<style>
    #layui-layer1{
        position: absolute\9;
        top:28.5px\9;
        left:0\9!important;
    }

    .confim_box tr td p.order_addedIRS{
        position: absolute;left: 155px;bottom: 77px;font-size:12px;line-height: 2;
    }

    @media screen and (max-width: 1366px) {
        .confim_box tr td p.order_addedIRS {
            bottom:5px;
        }
    }
</style>
<!--右侧内容区域-->
<div class="layui-tab layui-tab-card personCenter_all" id="basicMsg" style="overflow: inherit" v-cloak>
    <div class="personCenter_nav">
        <ul class="layui-tab-title">
            <!--<li class="layui-this">企业信息</li>-->
            <li class="layui-this" @click="personal()">个人信息</li>
            <li @click="InvoiceInformation()">发票信息</li>
            <li @click="address_List();tre_city()">收件信息</li>
            <li @click="personal();errors.clear('form-3-p');errors.clear('form-3-e');errors.clear('form-3-ps')">修改密码</li>
        </ul>
    </div>
    <div class="c_b"></div>
    <div class="layui-tab-content">
        <!--<div name="a" class="layui-tab-item layui-show">
            <div id="enterpriseInfo">
                <div class="enterpriseInfo-tip"><img style="width:16px;height:16px;margin:-3px 2px 0 0;" src="../img/1.png" alt="">您目前无法修改已认证的主体信息，如需修改请联系您的专属顾问</div>
                <div class="enterpriseInfo-l">
                    <ul v-if="companyMsg.companyname" style="padding-top: 40px;">
                        <li v-if="companyMsg.type==2">企业名称：<span>${companyMsg.companyname}</span></li>
                        <li v-if="companyMsg.type==2">营业执照号：<span class="address">${companyMsg.blicensenum}</span></li>
                        <li v-if="companyMsg.type==1">个体工商户名称：<span>${companyMsg.companyname}</span></li>
                        <li v-if="companyMsg.type==1">真实姓名：<span>${companyMsg.realname}</span></li>
                        <li v-if="companyMsg.type==1">身份证：<span class="address">${companyMsg.idcard}</span></li>
                    </ul>
                    <div v-if="!companyMsg.companyname">
                        <ul style="overflow: hidden;">
                            <li :class="{modifyRed:companyMsg.type==2,CompanyPares:true}" @click="companyMsg.type=2">公司</li>
                            <li :class="{modifyRed:companyMsg.type==1,CompanyPares:true}" @click="companyMsg.type=1">个体（个体工商户）</li>
                        </ul>
                        <form></form>
                        <form v-show="companyMsg.type==2" @submit.prevent="validateForm('form-comp')" data-vv-scope="form-comp">
                            <ul style="margin-left:22px;">
                                <li style="margin-bottom: 10px;overflow: hidden;"><span class="com_show">企业名称：</span>
                                    <input class="inputW f_l" name="companyname" type="text" v-model="compMsg.companyname" v-validate="'required'" data-vv-as="企业名称"
                                           :class="{'input': true, 'is-danger': errors.has('form-comp.companyname') }">
                                    <p class="red wrapper-sm" v-show="errors.has('form-comp.companyname')">${errors.first('form-comp.companyname')}</p>
                                </li>
                                <li style="margin-bottom: 10px;overflow: hidden;"><span class="com_show">营业执照号：</span>
                                    <input class="inputW f_l" type="text" v-model="companyMsg.blicensenum" data-vv-as="营业执照号"  name="blicensenum"
                                           :class="{'input': true, 'is-danger': errors.has('form-comp.blicensenum') }">
                                    <p class="red" v-show="errors.has('form-comp.blicensenum')">${errors.first('form-comp.blicensenum')}</p>
                                </li>
                            </ul>
                            <div class="enterpriseInfo-b">
                                <button class="butW80" type="submit">保存</button>
                            </div>
                        </form>
                        <form v-show="companyMsg.type==1" @submit.prevent="validateForm('form-perpson')" data-vv-scope="form-perpson">
                            <ul style="margin-left:22px;">
                                <li style="margin-bottom: 10px;overflow: hidden;"><span class="com_show">个体(个体工商户)名称：</span>
                                    <input class="inputW f_l" name="companyname" type="text" v-model="compMsg.companyname" v-validate="'required'" data-vv-as="个体（个体工商户）名称"
                                           :class="{'input': true, 'is-danger': errors.has('form-perpson.companyname') }">
                                    <p class="red wrapper-sm" v-show="errors.has('form-perpson.companyname')">${errors.first('form-perpson.companyname')}</p>
                                </li>
                                <li style="margin-bottom: 10px;overflow: hidden;"><span class="com_show">真实名称：</span>
                                    <input class="inputW f_l" name="realname" type="text" v-model="companyMsg.realname" data-vv-as="真实名称"
                                           :class="{'input': true, 'is-danger': errors.has('form-perpson.realname') }">
                                    <p class="red" v-show="errors.has('form-perpson.realname')">${errors.first('form-perpson.realname')}</p>
                                </li>
                                <li style="margin-bottom: 10px;overflow: hidden;"><span class="com_show">身份证号：</span>
                                    <input class="inputW f_l" type="text" v-model="companyMsg.idcard" v-validate="'sfzcode'" data-vv-as="身份证号"  name="sfzcode"
                                           :class="{'input': true, 'is-danger': errors.has('form-perpson.sfzcode') }">
                                    <p class="red wrapper-sm" v-show="errors.has('form-perpson.sfzcode')">${errors.first('form-perpson.sfzcode')}</p>
                                </li>
                            </ul>
                            <div class="enterpriseInfo-b">
                                <button class="butW80" type="submit">保存</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>-->

        <!--个人信息-->
        <div class="layui-tab-item layui-show">
            <form @submit.prevent="validateForm('form-2')" data-vv-scope="form-2">
                <div id="personInfo-content" class="personInfo-one"  >
                    <p>真实姓名：</p>
                    <p v-if="deitName==true" class="inputP">
                        <input type="text" v-model="personalList.nickname" class="inputW" disabled/>
                        <a style="margin-left: 30px;" @click="deitName=false">修改</a>
                    </p>
                    <p v-else class="inputP">
                        <input type="text" v-model="personalList.nickname" name="nickname" class="inputW" v-validate="'required'" data-vv-as="真实姓名"
                               :class="{'input': true, 'is-danger': errors.has('form-2.nickname') }"/>
                        <button class="per_btn">保存</button>
                    </p>
                    <p class="red p_form" v-show="errors.has('form-2.nickname')">${errors.first('form-2.nickname')}</p>
                    <p>QQ：</p>
                    <p v-if="deitName==true" class="inputP">
                        <input type="text" v-model="personalList.qq" class="inputW" disabled/>
                    </p>
                    <p v-else class="inputP">
                        <input type="text" v-model="personalList.qq" name="qqNum" class="inputW" v-validate="'qqNum'"
                               :class="{'input': true, 'is-danger': errors.has('form-2.qqNum') }"/>
                    </p>
                    <p class="red p_form" v-show="errors.has('form-2.qqNum')">${errors.first('form-2.qqNum')}</p>
                </div>
            </form>
            <form @submit.prevent="validateForm('form-2-p')" data-vv-scope="form-2-p">
                <div v-if="deitPhone">
                    <p>手机：</p>
                    <p class="inputP"><input type="text" v-model="personalList.tel" name="tel" class="inputW" disabled/></p>
                    <a v-if="!personalList.tel" style="margin-left: 30px;" @click="deitPhone=false">添加</a>
                </div>
                <div v-else>
                    <p>手机：</p>
                    <p class="inputP">
                        <input type="text" v-model="personalList.tel" name="phone" class="inputW"  v-validate:phone.initial="'phone'" data-vv-as="手机号码"
                               :class="{'input': true, 'is-danger': errors.has('phone') }" />
                    </p>
                    <p class="red clear-both" v-show="errors.has('phone')">${errors.first('phone')}</p>
                    <button class="per_btn">保存</button>
                </div>
            </form>
            <form @submit.prevent="validateForm('form-2-e')" data-vv-scope="form-2-e">
                <div v-if="deitEmail">
                    <p>邮箱：</p>
                    <p class="inputP">
                        <input type="text" v-model="personalList.email" class="inputW" disabled/>
                        <a v-if="!personalList.email" style="margin-left: 30px;" @click="deitEmail=false">添加</a>
                    </p>
                </div>
                <div v-else>
                    <p>邮箱：</p>
                    <p class="inputP">
                        <input type="text" v-model="personalList.email" class="inputW" name="emailNum" v-validate="'emailNum'"
                               :class="{'input': true, 'is-danger': errors.has('form-2-e.emailNum') }"/>
                        <button class="per_btn">保存</button>
                    </p>
                    <p class="red p_form" v-show="errors.has('form-2-e.emailNum')">${errors.first('form-2-e.emailNum')}</p>
                </div>
            </form>
        </div>








        <!--发票信息-->
        <div class="layui-tab-item " id="invoiceInfo" class="pickup-Info">
            <table class="pickup-table">
                <thead>
                    <tr>
                        <th>开票抬头</th>
                        <th>纳税人识别号</th>
                        <th>注册地址</th>
                        <th>注册电话</th>
                        <th>开户行</th>
                        <th>账号</th>
                        <th class="w194"></th>
                    </tr>
                </thead>
                <tbody id="invoiceBody">
                    <tr v-for="item in userBillInfoList" v-on:mouseenter="color_show($event,true)" v-on:mouseleave="color_show($event,false)">
                        <td nowrap="nowrap" :title="item.unitName">${item.unitName}</td>
                        <td  nowrap="nowrap" :title="item.taxpayerNo">${item.taxpayerNo}</td>
                        <td  nowrap="nowrap" :title="item.registerAddress">${item.registerAddress}</td>
                        <td  nowrap="nowrap" :title="item.registerPhone">${item.registerPhone}</td>
                        <td  nowrap="nowrap" :title="item.openBank">${item.openBank}</td>
                        <td  nowrap="nowrap" :title="item.bankAcount">${item.bankAcount}</td>
                        <td style="" class=" t-left">
                            <span data-method="notice" style="margin-right: 0;color: #2384cc;padding: 0 10px;" @click="changeInvoice(item.id)">修改</span>
                            <span data-method="notice" style="margin-left: 0;color: #2384cc;padding: 0 10px;" v-if="item.isDefault == 1"  @click="delInvoice(item.id,$event)">删除</span>
                            <span  class="default-address hide" style="display: none;margin-right:15px" v-if="item.isDefault == 1" @click="setInvoice(item.id)">设为默认</span>
                            <span class="hide_span" style="position: absolute;right: 15px;color: #5FB878;" v-if="item.isDefault == 2"> <i class="layui-icon">&#xe616;</i>默认地址</span>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="basicNoinfo" v-if="userBillInfoList.length==0">
                <dl>
                    <dt><img src="/img/icon-emptystate.png" /></dt>
                    <dd>暂无发票信息</dd>
                </dl>
            </div>
            <!--添加发票信息-->
            <div v-if="userBillInfoList.length >= 5" style="color:#D9344B;position: absolute;right: 150px;bottom:34px;">最多只能添加5条发票信息</div>
            <button id="addInvoice" @click="addInvoice()" data-method="notice" class="layui-btn layui-btn-primary layui-btn-small" :disabled="userBillInfoList.length >= 5">添加发票信息</button>
        </div>

        <!--编辑发票信息-->
        <div class="demandInvoice" id="dialog6" style="display: none">
            <!--普票   专票-->
            <div class="confim_invoceInfo" >
                <div style="clear: both"></div>
                <form  class="layui-form"  data-vv-scope="form-invoic11-add">
                    <table class="confim_box" ><tr><td class="confim_boxNum"><span>*</span>发票抬头：</td></tr>
                        <tr><td>
                            <input type="text" class="input" name="username" v-validate="'required'" data-vv-as="发票抬头"  v-model="invoiceData.unitName"
                                   :class="{'input': true, 'is-danger': errors.has('form-invoic11-add.username') }"/>
                            <p class="help is-danger" v-show="errors.has('form-invoic11-add.username')">${errors.first('form-invoic11-add.username')}</p>
                        </td></tr>
                        <tr><td class="confim_boxNum"><span>*</span>纳税人识别号：</td></tr>
                        <tr><td>
                            <input type="text" class="input" v-model="invoiceData.taxpayerNo" name="taxpayerNo" v-validate="'required|taxpayerNo'" data-vv-as="纳税人识别号"
                                   :class="{'input': true, 'is-danger': errors.has('form-invoic11-add.taxpayerNo') }"/>
                            <p  class="help is-danger" v-show="errors.has('form-invoic11-add.taxpayerNo')">${errors.first('form-invoic11-add.taxpayerNo')}</p>
                        </td></tr>
                        <tr><td class="confim_boxNum"><span></span>注册地址：</td></tr>
                        <tr><td>
                            <input type="text" class="input" v-model="invoiceData.registerAddress" />
                        </td></tr>
                        <tr><td class="confim_boxNum"><span></span>注册电话：</td></tr>
                        <tr><td>
                            <input type="text" class="input" name="registerPhone" v-model="invoiceData.registerPhone" v-validate="'phone'" data-vv-as="注册电话"
                                   :class="{'input': true, 'is-danger': errors.has('form-invoic11-add.registerPhone') }"/>
                            <p class="help is-danger" v-show="errors.has('form-invoic11-add.registerPhone')">${errors.first('form-invoic11-add.registerPhone')}</p>
                        </td></tr>
                        <tr><td class="confim_boxNum"><span></span>开户银行：</td></tr>
                        <tr><td>
                            <input type="text" class="input"  v-model="invoiceData.openBank"/>
                        </td></tr>
                        <tr><td class="confim_boxNum"><span></span>银行账号：</td></tr>
                        <tr><td>
                            <input type="text" class="input" v-model="invoiceData.bankAcount" name="bankUserAcount" v-validate="'num'" data-vv-as="银行账号"
                                   :class="{'input': true, 'is-danger': errors.has('form-invoic11-add.bankUserAcount') }"/>
                            <p class="help is-danger" v-show="errors.has('form-invoic11-add.bankUserAcount')">${errors.first('form-invoic11-add.bankUserAcount')}</p>
                        </td></tr>
                        <tr><td class="confim_boxNum"><span></span>一般纳税人证明：</td></tr>
                        <tr style="position: relative;">
                            <td style="margin-bottom: 15px;">
                                <div class="upload_add_file" style="border: none;">
                                    <div id="item_addInfo11" class="f_l" v-show="!eaddTaxpayerPath" style='width:100px;height:100px;border: 1px dashed #979797;'>
                                        <a data-method="notice"  id="addInfo11"></a>
                                        <!--<img src="\img\icon_upload_plus.png" alt="" style="width: 24px;height:24px;margin-left:37px;margin-top: -134px;">-->
                                    </div>
                                    <input type="hidden" class="hide" name="eaddTaxpayerPath" v-model="eaddTaxpayerPath"  class="inputW" >
                                    <div class="pictureShow" v-show="eaddTaxpayerPath">
                                        <img class="picture" :src="eaddTaxpayerPath"  alt="" style="width:102px;height:102px;display: inline-block">
                                        <img src="\img\icon_upload_delete.png" class="icon_delete" @click="eaddTaxpayerPath = '';invoiceData.taxpayerPath = ''">
                                    </div>
                                </div>
                                <p class="order_addedIRS" style="">一般纳税人证明可以企业对应省国税局网站查询截取如：<a target="_blank" href="/cooperation/addedIRS" style="color:rgb(35, 132, 204);display: block">${host}/cooperation/addedIRS</a></p>
                                <p style="margin-top:-20px;margin-left: 110px;">请上传一般纳税人证明</p>
                            </td>
                        </tr>
                    </table>
                </form>
            </div>
        </div>
        <!--添加发票信息-->
        <div class="demandInvoice" id="dialog5" style="display: none">
            <!--普票   专票-->
            <div class="confim_invoceInfo" >
                <div style="clear: both"></div>
                <form  class="layui-form"  data-vv-scope="form-invoic-add">
                    <table class="confim_box" ><tr><td class="confim_boxNum"><span>*</span>发票抬头：</td></tr>
                        <tr><td>
                            <input type="text" class="input" name="username" v-validate="'required'" data-vv-as="发票抬头"  v-model="invoiceData.unitName"
                                   :class="{'input': true, 'is-danger': errors.has('form-invoic-add.username') }"/>
                            <p class="help is-danger" v-show="errors.has('form-invoic-add.username')">${errors.first('form-invoic-add.username')}</p>
                        </td></tr>
                        <tr><td class="confim_boxNum"><span>*</span>纳税人识别号：</td></tr>
                        <tr><td>
                            <input type="text" class="input" v-model="invoiceData.taxpayerNo" name="taxpayerNo" v-validate="'required|taxpayerNo'" data-vv-as="纳税人识别号"
                                   :class="{'input': true, 'is-danger': errors.has('form-invoic-add.taxpayerNo') }"/>
                            <p  class="help is-danger" v-show="errors.has('form-invoic-add.taxpayerNo')">${errors.first('form-invoic-add.taxpayerNo')}</p>
                        </td></tr>
                        <tr><td class="confim_boxNum"><span></span>注册地址：</td></tr>
                        <tr><td>
                            <input type="text" class="input" v-model="invoiceData.registerAddress" />
                        </td></tr>
                        <tr><td class="confim_boxNum"><span></span>注册电话：</td></tr>
                        <tr><td>
                            <input type="text" class="input" name="registerPhone" v-model="invoiceData.registerPhone" v-validate="'phone'" data-vv-as="发票抬头"
                                   :class="{'input': true, 'is-danger': errors.has('form-invoic-add.registerPhone') }"/>
                            <p class="help is-danger" v-show="errors.has('form-invoic-add.registerPhone')">${errors.first('form-invoic-add.registerPhone')}</p>
                        </td></tr>
                        <tr><td class="confim_boxNum"><span></span>开户银行：</td></tr>
                        <tr><td>
                            <input type="text" class="input"  v-model="invoiceData.openBank"/>
                        </td></tr>
                        <tr><td class="confim_boxNum"><span></span>银行账号：</td></tr>
                        <tr><td>
                            <input type="text" class="input" v-model="invoiceData.bankAcount" name="bankUserAcount" v-validate="'num'" data-vv-as="银行账号"
                                   :class="{'input': true, 'is-danger': errors.has('form-invoic-add.bankUserAcount') }"/>
                            <p class="help is-danger" v-show="errors.has('form-invoic-add.bankUserAcount')">${errors.first('form-invoic-add.bankUserAcount')}</p>
                        </td></tr>
                        <tr><td class="confim_boxNum"><span></span>一般纳税人证明：</td></tr>

                        <tr style="position: relative;">
                            <td style="margin-bottom: 15px;">
                                <div class="upload_add_file" style="border: none;">
                                    <div id="item_addInfo" class="f_l" v-show="!addTaxpayerPath" style='width:100px;height:100px;border: 1px dashed #979797;'>
                                        <a data-method="notice"  id="addInfo"></a>
                                        <!--<img src="\img\icon_upload_plus.png" alt="" style="width: 24px;height:24px;margin-left:37px;margin-top: -134px;">-->
                                    </div>
                                    <input type="hidden" class="hide" name="addTaxpayerPath" v-model="addTaxpayerPath"  class="inputW" >
                                    <div class="pictureShow" v-show="addTaxpayerPath">
                                        <img class="picture" :src="contractUrl+addTaxpayerPath"  alt="" style="width:102px;height:102px;display: inline-block">
                                        <img src="\img\icon_upload_delete.png" class="icon_delete" @click="addTaxpayerPath = ''">
                                    </div>
                                </div>
                                <p class="order_addedIRS" style="">一般纳税人证明可以企业对应省国税局网站查询截取如：<a target="_blank" href="/cooperation/addedIRS" style="color:rgb(35, 132, 204);display: block">${host}/cooperation/addedIRS</a></p>
                                <p style="margin-top:-20px;margin-left: 110px;">请上传一般纳税人证明</p>
                            </td>
                        </tr>
                    </table>
                </form>
            </div>
        </div>





        <!--收件信息-->
        <div class="layui-tab-item " id="pickup-Info" class="pickup-Info">
            <table class="pickup-table">
                <thead>
                <tr>
                    <th style="">收件人姓名</th>
                    <th>手机号码</th>
                    <th>收件地址</th>
                    <th class="w194">操作</th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="listTr in addressList" class="sty_css" v-on:mouseenter="color_show($event,true)" v-on:mouseleave="color_show($event,false)">
                    <td style="">

                        <span v-html="listTr.recipientName"></span>
                        <input class="add_dis inputW" v-model="listTr.recipientName" type="text">
                    </td>
                    <td>
                        <span v-html="listTr.recipientPhone"></span>
                        <input v-model="listTr.recipientPhone" class="add_dis inputW" type="text">
                    </td>
                    <td style="text-align: left;width:430px;line-height: 46px;">
                        <div style="margin-left: 20px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;width: 440px;height: 30px;display: inline-block;">${listTr.provinceDesc}${listTr.cityDesc}${listTr.countryDesc||''}${listTr.recipientAddress}</div>
                        <input v-model="listTr.recipientName" class="add_dis inputW" type="text">
                    </td>
                    <td class="w194 t-left">
                            <span @click="edit_arress($event,listTr.id);btn_one=1;errors.clear();" class="layui-btn" data-method="notice" style="margin-right: 0;background-color: inherit;">编辑</span>
                        <span v-show="listTr.isDefault==0" @click="del_arress($event,listTr.id)" id="del_arress" class="layui-btn" data-method="notice" style="margin-right: 0;background-color: inherit;">删除</span>
                    <!--<span class="hide_span" v-show="listTr.isDefault == 1" style="color: #a34a51">默认地址</span>-->
                        <span v-if="listTr.isDefault !== 1" @click="set_default(listTr.id)" class="default-address hide" style="display: none">设为默认</span>
                        <span class="hide_span" v-show="listTr.isDefault == 1" style="position: absolute;right: 6px;color: #5FB878;"> <i class="layui-icon">&#xe616;</i>默认地址</span>
                    </td>
                </tr>
                </tbody>
            </table>
            <div class="basicNoinfo" v-if="addressList.length==0">
                <dl>
                    <dt><img src="/img/icon-emptystate.png" /></dt>
                    <dd>暂无地址信息</dd>
                </dl>
            </div>
            <button id="add" @click="add_arress($event);btn_one=1;errors.clear();add_ress=false" data-method="notice" class="layui-btn layui-btn-primary layui-btn-small">添加收件地址</button>
        </div>
        <!--添加收货地址-->
        <form id="dialog" @submit.prevent="validateForm('form-address-add')" data-vv-scope="form-address-add" class="hide">
            <div class="add-title-content" style="padding: 25px 25px;">
                <div class="layui-form-item">
                    <div class="form-div"><span>姓名：</span>
                        <input type="text" v-model="address.name" name="username" class="inputW"  v-validate="'required'" data-vv-as="姓名"
                               :class="{'input': true, 'is-danger': errors.has('form-address-add.username') }"/>
                        <p class="red clear-both" v-show="errors.has('form-address-add.username')">${errors.first('form-address-add.username')}</p>
                    </div>
                    <div class="form-div"><span style="padding-left:0; ">手机号码：</span>
                        <input v-model="address.phone" name="phone" class="inputW"  v-validate="'required|phone'" data-vv-as="手机号码"
                               :class="{'input': true, 'is-danger': errors.has('form-address-add.phone') }" />
                        <p class="red clear-both" v-show="errors.has('form-address-add.phone')">${errors.first('form-address-add.phone')}</p>
                    </div>
                    <div class="form-div">
                        <span>地址：</span>
                        <select class="address-select" name="quiz" v-model="address.selected_p" id="selected_p" @change="tre_add_city(2)"  v-validate="'required'" data-vv-as="地址"
                                :class="{'input': true, 'is-danger': errors.has('form-address-add.recipientAddress') }" >
                            <option v-for="p in province" v-bind:value="p.code" v-html="p.name"></option>
                        </select>
                        <select class="address-select" name="quiz2" v-model="address.selected_c" @change="tre_add_city(3)" :class="{'input': true, 'is-danger': errors.has('form-address-add.recipientAddress') }">
                            <option v-for="c in city.data" v-bind:value="c.code" v-html="c.name"></option>
                        </select>
                        <select v-show="selected_show" class="address-select" name="quiz3" v-model="address.selected_co" :class="{'input': true, 'is-danger': errors.has('form-address-add.recipientAddress') }">
                            <option v-for="co in country.data" v-bind:value="co.code" v-html="co.name"></option>
                        </select>
                    </div>
                    <div v-show="address.selected_c">
                        <input type="text" placeholder="" v-model="address.recipientAddress" name="recipientAddress" id="add_address" class="inputW" maxlength="100"
                               v-validate="'required'" data-vv-as="地址" :class="{'input': true, 'is-danger': errors.has('form-address-add.recipientAddress') }" />
                    </div>
                    <p class="red clear-both" v-show="errors.has('form-address-add.recipientAddress')">${errors.first('form-address-add.recipientAddress')}</p>
                </div>
                <div style="margin-top: 30px;cursor: pointer" class="dialog_cancel">
                    <span class="address_addees" @click="close_open">取消</span>
                    <span class="address_close" @click="validateForm('form-address-add')">保存并设置为默认</span>
                </div>
            </div>
        </form>
        <!--修改收货地址-->
        <div id="edit_dialog" class="hide">
            <div class="add-title-content" style="padding: 25px 25px">
                <div class="layui-form-item">
                    <div class="form-div"><span>姓名：</span>
                        <input type="text" v-model="name" name="username" class="inputW"  v-validate:username.initial="'required'" data-vv-as="姓名"
                               :class="{'input': true, 'is-danger': errors.has('username') }"/>
                        <p class="red clear-both" v-show="errors.has('username')">${errors.first('username')}</p>
                    </div>
                    <div class="form-div"><span style="padding-left:0; ">手机号码：</span>
                        <input v-model="phone" name="phone" type="tel"   class="inputW"  v-validate:phone.initial="'required|phone'" data-vv-as="手机号码"
                               :class="{'input': true, 'is-danger': errors.has('phone') }" />
                        <p class="red clear-both" v-show="errors.has('phone')">${errors.first('phone')}</p>
                    </div>
                    <div class="form-div">
                        <span>地址：</span>
                        <select class="address-select" name="quiz1" v-model="selected_p" id="selected_p" @change="tre_city()"  v-validate:quiz1.initial="'required'" data-vv-as="地址"
                                :class="{'input': true, 'is-danger': errors.has('quiz1') }" >
                            <option v-for="p in province" v-bind:value="p.code" v-html="p.name"></option>
                        </select>
                        <select class="address-select" name="quiz2" v-model="selected_c" @change="tre_country()"v-validate:quiz2.initial="'required'" :class="{'input': true, 'is-danger': errors.has('quiz2') }">
                            <option v-for="c in city.data" v-bind:value="c.code" v-html="c.name"></option>
                        </select>
                        <select v-show="selected_show" class="address-select" name="quiz3" v-model="selected_co" :class="{'input': true, 'is-danger': errors.has('quiz1') }">
                            <option v-for="co in country.data" v-bind:value="co.code" v-html="co.name"></option>
                        </select>
                        <p class="red clear-both" v-show="errors.has('quiz1')">${errors.first('quiz1')}</p>
                    </div>
                    <div>
                        <input type="text" placeholder="" v-model="recipientAddress" name="recipientAddress" id="add_address" class="inputW" maxlength="100"
                               v-validate:recipientAddress.initial="'required'" data-vv-as="详细地址" :class="{'input': true, 'is-danger': errors.has('recipientAddress') }" />
                        <p class="red clear-both" v-show="errors.has('recipientAddress')">${errors.first('recipientAddress')}</p>
                    </div>

                </div>
            </div>
        </div>
        <!--修改密码-->
        <div class="layui-tab-item" id="personInfo">
            <!--第二个页面-->
            <div v-show="deit_one==2" id="personInfo-verification" class="personInfo-two">
                <span>验证方式：</span>
                <br/>
                <select id="verification-mode" v-model="pw_show" @click="errors.clear('form-3-p');errors.clear('form-3-e');errors.clear('form-3-ps')">
                    <option v-if="personalList.tel" value="1" class="verification-tel">手机验证</option>
                    <option v-if="personalList.email" value="2" class="verification-email">邮箱验证</option>
                    <option value="3" class="verification-raw">原密码验证</option>
                </select>
                <br/>
                    <form v-show="pw_show==1" class="verification-tel-show" @submit.prevent="validateForm('form-3-p')" data-vv-scope="form-3-p">
                        <span>手机：</span>
                        <br/>
                        <p style="height: 50px">
                            <input v-model="personalList.tel" type="text" class="inputW not-active" name="" disabled />
                            <a v-if="!isDis" class="code_btn" v-bind:disabled="isDis" @click="passportCode('form-3-p')" v-bind:class="{ disabled: isDis }">${codeHtml}</a>
                            <button v-bind:disabled="isDis" v-else class="code_btn">${codeHtml}</button>
                        </p>
                        <span>验证码：</span>
                        <br/>
                        <input type="text" placeholder="请收入验证码" v-model="userData.code" name="code" class="inputW" v-validate="'required'" data-vv-as="验证码"
                               :class="{'input': true, 'is-danger': errors.has('form-3-p.code') }"/>
                        <p class="red p_form" v-show="errors.has('form-3-p.code')" style="line-height: 40px;">${errors.first('form-3-p.code')}</p>
                        <div class="personInfo-verification-b">
                            <button class="butW80 personInfo-verification-next" @click="errors.clear('form-3-p');">下一步</button>
                        </div>
                    </form>
                    <form v-show="pw_show==2" @submit.prevent="validateForm('form-3-e')" data-vv-scope="form-3-e">
                        <span>邮箱：</span>
                        <br/>
                        <p style="height: 50px">
                            <input type="text" v-model="personalList.email" class="inputW not-active" disabled />
                            <a v-if="!isDis" class="code_btn" v-bind:disabled="isDis" @click="passportCode('form-3-e')" v-bind:class="{ disabled: isDis }">${codeHtml}</a>
                            <button v-bind:disabled="isDis" v-else class="code_btn">${codeHtml}</button>
                        </p>
                        <span>验证码：</span>
                        <br/>
                        <input type="text" placeholder="请收入验证码" v-model="userData.email" name="code" class="inputW" v-validate="'required'" data-vv-as="验证码"
                               :class="{'input': true, 'is-danger': errors.has('form-3-e.code') }"/>
                        <p class="red p_form" v-show="errors.has('form-3-e.code')" style="line-height: 40px;">${errors.first('form-3-e.code')}</p>
                        <div class="personInfo-verification-b">
                            <button class="butW80 personInfo-verification-next" @click="errors.clear('form-3-e');">下一步</button>
                        </div>
                    </form>

                    <form v-show="pw_show==3" @submit.prevent="validateForm('form-3-ps')" data-vv-scope="form-3-ps">
                        <span>请输入原密码：</span>
                        <br/>
                        <input type="password" placeholder="请输入原密码"  v-model="userData.oPassword" name="oPassword" class="inputW" v-validate="'required'" data-vv-as="密码"
                               :class="{'input': true, 'is-danger': errors.has('form-3-ps.oPassword') }"/>
                        <p class="red p_form" v-show="errors.has('form-3-ps.oPassword')" style="line-height: 40px;">${errors.first('form-3-ps.oPassword')}</p>
                        <br/>
                        <div class="personInfo-verification-b">
                            <button class="butW80 personInfo-verification-next" @click="errors.clear('form-3-ps')">下一步</button>
                        </div>
                    </form>


            </div>
            <!--第三个页面-->
            <form v-show="deit_one==3" id="personInfo-Password" class="personInfo-three" @submit.prevent="validateForm('form-4')" data-vv-scope="form-4">
                <div>
                    <div style="overflow: hidden;">
                        <span>请输入密码：</span><br>
                        <input type="password" class="inputW" v-model="password"  name="passWord" v-validate="'required|pwsLength'" data-vv-as="密码"
                               placeholder="请输入密码"  :class="{'input': true, 'is-danger': errors.has('form-4.passWord') }"/>
                        <p class="red p_form" v-show="errors.has('form-4.passWord')" style="line-height: 40px;">${errors.first('form-4.passWord')}</p>
                    </div>

                    <p style="color: #b9bfc7;font-size: 12px;margin-bottom: 20px;">6-20位字符，建议用字母，数字和符号两种以上组合</p>
                </div>
                <div class="clear-both"></div>
               <div>
                   <span>请再次输入密码：</span><br>
                   <input type="password" placeholder="请再次输入密码" v-model="passWordes" class="inputW" name="passWordes"  v-validate="'required|passWordes'" data-vv-as="密码"
                          placeholder="请输入密码"  :class="{'input': true, 'is-danger': errors.has('form-4.passWordes') }"/>
                   <p class="red p_form" v-show="errors.has('form-4.passWordes')" style="line-height: 40px;">${errors.first('form-4.passWordes')}</p>
                   <div class="personInfo-Password-b">
                       <button class="butW80">完成</button>
                   </div>
               </div>
            </form>
        </div>
    </div>
</div>
</div>
</div>
<script type="text/javascript">
    var num = {
        messages: {
            en: function en(field, args) {
                return args + '请输入正确的银行账号！';
            }
        },
        validate: function validate(value, args) {
            return ((/\d+/.test(value)));
        }
    };
    VeeValidate.Validator.extend('num', num);
    var pwsLength = {
        messages: {
            en: function en(field, args) {
                return args + '请输入6-20位字符';
            }
        },
        validate: function validate(value, args) {
            return value.length>=6&&value.length<=20;
        }
    };
    VeeValidate.Validator.extend('pwsLength', pwsLength);
    var qqNum = {
        messages: {
            en: function en(field, args) {
                return args + '请输入正确的QQ号';
            }
        },
        validate: function validate(value, args) {
            return (/^([1-9][0-9]{5,11})$/.test(value));
        }
    };
    VeeValidate.Validator.extend('qqNum', qqNum);
    var emailNum = {
        messages: {
            en: function en(field, args) {
                return args + '请输入正确的邮箱号';
            }
        },
        validate: function validate(value, args) {
            return (/\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14}/.test(value));
        }
    };
    VeeValidate.Validator.extend('emailNum', emailNum);
    var taxpayerNo = {
        messages: {
            en: function en(field, args) {
                return args + '纳税人识别必须是15-20字符';
            }
        },
        validate: function validate(value, args) {
            return (/^[A-Za-z0-9]{15,20}$/.test(value));
        }
    };
    var phone = {
        messages: {
            en: function en(field, args) {
                return args + '请输入正确的电话或手机号码';
            }
        },
        validate: function validate(value, args) {
            return ((/^(1[3-9][0-9]{9})$/.test(value))|| (/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/).test(value));
        }
    };
    VeeValidate.Validator.extend('taxpayerNo', taxpayerNo);
    VeeValidate.Validator.extend('phone', phone);
    var  company = {{{ uData }}};
    $('.sty_css').on('hover',function () {
        $(this).addClass('hide_span').siblings().removeClass('hide_span');
    });
    layui.use('layer', function() { //独立版的layer无需执行这一句
        var $ = layui.jquery, layer = layui.layer,that=''; //独立版的layer无需执行这一句
        var basicMsgVM = new Vue({
            el:'#basicMsg',
            delimiters:["${", "}"],
            data:{
                add_ress:false,
//                compMsg:{type:2},
                deit_one:2,
                deit_two:true,
//                companyMsg:company.data||{type:2},
                deitName:true,
                deitQQ:true,
                addressList:[],
                selected_p:[],
                province:[],
                city:{data:[]},
                selected_c:[],
                country:{data:[]},
                selected_co:[],
                name:'',
                phone:'',
                recipientAddress:'',
                personalList:company.data||[],
                is_true:false,
                selected_show:true,
                codeHtml:'获取验证码',
                isDis:false,
                Td:null,
                password:null,
                passWordes:null,
                pw_show:1,
                userData:{},
                deitPhone:true,
                deitEmail:true,
                address:{},
                userBillInfoList:[],//用户发票信息数据
                invoiceData: {},//编辑信息数据
                billType:1,//普票专票类型
                contractUrl:zgg.Vconfig.contractUrl,
                addTaxpayerPath:'',//纳税人证明
                eaddTaxpayerPath:'',
                txtType:['jpg','png','jpeg'],
                ImgUrl:zgg.Vconfig.ImgUrl,
                host:window.location.host,
            },
            mounted:function(){
                this.updataFile('#addInfo', 'item_addInfo', 'addTaxpayerPath'); //添加纳税人证明
                this.updataFile('#addInfo11', 'item_addInfo11', 'eaddTaxpayerPath'); //添加纳税人证明
            },
            methods:{
                //请求数据
                address_List:function () {
                    axios.get('/userCenter/addressList?'+new Date).then(
                            function (addressList) {
                                basicMsgVM.addressList = addressList.data.data;
                            }
                    );
                    axios.get('/region.json').then(
                            function (data) {
                                basicMsgVM.province = data.data.data;
                            }
                    )
                },
                tre_add_city:function (num) {
                    var that = this;
                    if(num==2){
                        that.province.map(function (item) {
                            if(item.code == that.address.selected_p){
                                that.$set(that.city,'data',item.sub);
                            }
                        });
                        that.$set(that.address.country,'data',[]);
                        that.selected_show=true;
                    }else if(num==3){
                        that.city.data.map(function (item) {
                            if(item.code == that.address.selected_c){
                                that.$set(that.country,'data',item.sub);
                                that.selected_show=true;
                                if(item.sub.length==0){
                                    that.selected_show=false;
                                }
                            }
                        });
                    }
//                    if(that.selected_show&&this.address.selected_co){
//                        this.add_ress = true;
//                    }else if(address.selected_c){
//                        this.add_ress = true;
//                    }

                },
                tre_city:function () {
                    var that = this;
                    that.province.map(function (item) {
                        if(item.code == that.selected_p){
                            that.$set(that.city,'data',item.sub);
                        }
                    });
                    that.$set(that.country,'data',[]);
                    that.selected_show=true;
                },
                tre_country:function () {
                    var that = this;
                    that.city.data.map(function (item) {
                        if(item.code == that.selected_c){
                            that.$set(that.country,'data',item.sub);
                            that.selected_show=true;
                            if(item.sub.length==0){
                                that.selected_show=false;
                            }
                        }
                    });
                },
                //点击发票信息列表
                InvoiceInformation:function () {
                    axios.post('/userCenter/getZgUserBillInfoList/',{mode:1}).then(function (data) {
                        basicMsgVM.userBillInfoList = data.data.data;
                    });
                },
                //编辑发票信息
                changeInvoice:function(id){
                        axios.post('/userCenter/getZgUserBillInfoListById/' ,{id:id} )
                                .then(function(res) {
                                    basicMsgVM.invoiceData = res.data.data[0];
                                    basicMsgVM.eaddTaxpayerPath = basicMsgVM.invoiceData.taxpayerPath;
                                    var lay = layer.open({
                                        type: 1,
                                        title: "编辑发票",//false不显示标题栏,
                                        closeBtn: false,//是否显示头部删除按钮
                                        offset: '30px',
                                        area: '480px',
                                        shade: 0.6,
                                        scrollbar: false,
                                        id: 'LAY_layuipro_comInvoice',//设定一个id，防止重复弹出,
                                        btn: ['保存', '取消'],
                                        btnAlign: 'c',
                                        moveType: 1,//拖拽模式，0或者1,
                                        content: $("#dialog6"),
                                        success: function (layero) {
                                        },
                                        btn2: function () {
                                            layer.close(lay)
                                        },
                                        yes: function () {
                                            if(basicMsgVM.invoiceData.taxpayerPath){
                                                basicMsgVM.invoiceData.taxpayerPath = '/base' + basicMsgVM.invoiceData.taxpayerPath.split('/base')[1];
                                            }
                                            basicMsgVM.$validator.validateAll('form-invoic11-add').then(function (result) {
                                                if (result) {
                                                    axios.put('/userCenter/updateZgUserBillInfo', basicMsgVM.invoiceData)
                                                            .then(function () {
                                                                layui.use('layer', function () {
                                                                    layer.msg('修改成功', {icon: 1});
                                                                    layer.close(lay)
                                                                    setTimeout(function () {
                                                                        axios.post('/userCenter/getZgUserBillInfoList/', {mode: 1}).then(function (data) {
                                                                            basicMsgVM.userBillInfoList = data.data.data;
                                                                        });
                                                                    }, 800)
                                                                })
                                                            })
                                                }
                                            },function(){
                                                layer.msg('修改失败',{icon:2})
                                                return false;
                                            })
                                        }
                                    })
                                })
                },
                //添加发票信息
                addInvoice:function(){
                    basicMsgVM.errors.clear('form-invoic-add');
                    axios.post('/userCenter/getZgUserBillInfoList/',{mode:1}).then(function (data) {
                        basicMsgVM.userBillInfoList = data.data.data;
                        if(basicMsgVM.userBillInfoList == 0 ){
                            basicMsgVM.invoiceData.isDefault = 2;
                        }else if(basicMsgVM.userBillInfoList != 0 ){
                            basicMsgVM.invoiceData.isDefault = 1;
                        }
                    });
                    basicMsgVM.invoiceData = {
                        "unitName":"",
                        "taxpayerNo":"",
                        "registerAddress":"",
                        "registerPhone":"",
                        "openBank":"",
                        "bankAcount":""
                    }
                    basicMsgVM.addTaxpayerPath = '';
                    console.log(basicMsgVM.invoiceData)
                    var lay = layer.open({
                        type: 1,
                        title: "新增发票",//false不显示标题栏,
                        closeBtn: false,// 是否显示头部删除按钮
                        offset: '30px',
                        area: '480px',
                        shade: 0.6,
                        scrollbar: false,
                        id: 'LAY_layuipro_addInvoice' ,//设定一个id，防止重复弹出,
                        btn: ['保存', '取消'],
                        btnAlign: 'c',
                        moveType: 1 ,//拖拽模式，0或者1,
                        content: $("#dialog5"),
                        btn2:function () {
                            layer.close(lay);
                        },
                        yes:function () {
                            if(basicMsgVM.invoiceData.taxpayerPath){
                                basicMsgVM.invoiceData.taxpayerPath = '/base' + basicMsgVM.invoiceData.taxpayerPath.split('/base')[1];
                            }
                            basicMsgVM.$validator.validateAll('form-invoic-add').then(function (result) {
                                if(result){
                                    axios.post('/userCenter/saveZgUserBillInfo',basicMsgVM.invoiceData)
                                            .then(function(res){
                                                layui.use('layer',function(){
                                                    layer.msg('添加成功',{icon:1})
                                                    layer.close(lay)
                                                })
                                                setTimeout(function(){
                                                    axios.post('/userCenter/getZgUserBillInfoList/',{mode:1}).then(function (data) {
                                                        basicMsgVM.userBillInfoList = data.data.data;
                                                    });
                                                },800)
                                            })
                                }
                            })
                            return false;
                        }
                    });
                },
                //设为默认发票
                setInvoice:function(id){
                    axios.put('/userCenter/updateZgUserBillInfoIsDefaultById/',{"id":id}).then(function (data) {
                        layer.msg('修改成功!!!',{icon:1});
                        setTimeout(function(){
                            axios.post('/userCenter/getZgUserBillInfoList/',{mode:1}).then(function (data) {
                                basicMsgVM.userBillInfoList = data.data.data;
                            });
                        },800)
                    })
                },
                //删除发票
                delInvoice:function(id,ev){
                    var index = $(ev.target).parents('tr').index();
                   $.ajax({
                        url:'/userCenter/deleteZgUserBillInfoById',
                        type:'post',
                        data:{id:id},
                        success: function(data) {
                            if (data.success) {
                                basicMsgVM.userBillInfoList.splice(index,1);
                                layui.use('layer',function(){
                                    layer.msg('删除成功！',{icon:1})
                                })
                            }else{
                                layui.use('layer',function(){
                                    layer.msg( data.message,{icon:1})
                                })
                            }
                        }
                    });
                },
                //上传图片
                updataFile:function (_str,queId,imgUrl,other) {
                    if(navigator.appName == "Microsoft Internet Explorer" && navigator.appVersion .split(";")[1].replace(/[ ]/g,"")=="MSIE9.0") {
                        var _fileSizeLimit =  '2MB', _fileTypeExts = '*.jpg;*.bmp;*.jpeg;*.png;*.gif;';
                        if(_oth === 'other' ){
                            _fileSizeLimit =  '100MB';
                            _fileTypeExts = '*.jpg;*.gif;*.png;*.bmp;*.doc;*.docx;*.xls;*.xlsx;*.ppt;*.pptx;*.pdf;*.txt;*.rar;*.zip';
                        }
                        $(_str).uploadify({
                            'auto' : true,
                            'queueID' : queId,
                            'checkScript':'/upload/check',
                            'uploadScript' : '/upload/profile',
                            'buttonCursor':'hand',
                            'buttonText':'',
                            "buttonClass":"addFile",
                            'width': 90,
                            'method' : 'post',
                            'fileSizeLimit ': 1024 * 1024 * 2,
                            'fileType': '*.jpg;*.jpeg;*.png;',
                            'progressData':'percentage',
                            'formData':{
                                'fType':"ft_8"
                            },
                            'onDrop':function(file, fileDropCount) {
                                debugger;
                            },
                            'onFallback':function () {
                                alert('请安装或升级更高版本的Flash插件');
                            },
                            'onUploadComplete' : function(file, data, response) {
                                if(imgUrl == 'addTaxpayerPath'){
                                    basicMsgVM.invoiceData.taxpayerPath = JSON.parse(data).data.filePath;
                                    basicMsgVM.addTaxpayerPath =  basicMsgVM.invoiceData.taxpayerPath;
                                }else if(imgUrl == 'eaddTaxpayerPath'){
                                    basicMsgVM.invoiceData.taxpayerPath = basicMsgVM.contractUrl + JSON.parse(data).data.filePath;
                                    basicMsgVM.eaddTaxpayerPath =  basicMsgVM.invoiceData.taxpayerPath;
                                }
                                layer.msg('上传成功',{icon:1});
                            },
                            'onCheck'  : function(file, exists) {
                                if (basicMsgVM.txtType.indexOf(file.name.split(".")[file.name.split(".").length - 1]) == -1) {
                                    layer.msg("请上传jpg,png,jpeg,pdf格式图片！");
                                    $(_str).uploadifive('cancel', file)
                                }
                            },
                            'onError' : function (file, data, response) {
                                debugger;
                            }
                        })
                    }else{
                        $(_str).uploadifive({
                            'auto' : true,
                            'queueID' : queId,
                            'checkScript':'/upload/check',
                            'uploadScript' : '/upload/profile',
                            'buttonCursor':'hand',
                            'buttonText':'',
                            "buttonClass":"addFile",
                            'width': 90,
                            'method' : 'post',
                            'fileSizeLimit ': 1024 * 1024 * 2,
                            'fileType': '*.jpg;*.jpeg;*.png;',
                            'progressData':'percentage',
                            'formData':{
                                'fType':"ft_8"
                            },
                            'onDrop':function(file, fileDropCount) {
                                debugger;
                            },
                            'onUploadComplete' : function(file, data, response) {
                                if(imgUrl == 'addTaxpayerPath'){
                                    basicMsgVM.invoiceData.taxpayerPath = JSON.parse(data).data.filePath;
                                    basicMsgVM.addTaxpayerPath =  basicMsgVM.invoiceData.taxpayerPath;
                                }else if(imgUrl == 'eaddTaxpayerPath'){
                                    basicMsgVM.invoiceData.taxpayerPath = basicMsgVM.contractUrl +JSON.parse(data).data.filePath;
                                    basicMsgVM.eaddTaxpayerPath =  basicMsgVM.invoiceData.taxpayerPath;
                                }
                                layer.msg('上传成功',{icon:1});
                            },
                            'onCheck'  : function(file, exists) {
                                if (basicMsgVM.txtType.indexOf(file.name.split(".")[file.name.split(".").length - 1].toLowerCase()) == -1) {
                                    layer.msg("请上传jpg,png,jpeg格式图片！");
                                    $(_str).uploadifive('cancel', file)
                                }
                            },
                            'onError' : function (file, data, response) {
                                debugger;
                            }
                        })
                    }
                },
                validateForm:function(scope) {
                    this.$validator.validateAll(scope).then(function(result) {
                        if (result) {
                            // eslint-disable-next-line
                            /* alert('Form Submitted!');*/
                            if(scope == 'form-1'){
                                orderVM.billTextName = orderVM.billName;
                            }
                            if(scope == 'form-2'){
                                orderVM.billTextName = orderVM.zgVatInfo.unitName;
                            }
                            orderVM.billTypeTemp =  orderVM.billType;
                            layer.close(addressOpen);
                            $("#BillBox").hide();
                        }
                    });
                },



                //添加收货信息
                add_arress:function (t) {
//                    this.name=this.phone=this.recipientAddress="";
//                    this.selected_p=this.selected_c=this.selected_co=[];
                    basicMsgVM.address = {};
                    basicMsgVM.btn_one=1;
                    var layer_type = {
                        type: 1,
                        title: "新增地址",//false不显示标题栏,
                        // closeBtn: false,是否显示头部删除按钮
//                        offset: '100px',
                        area: '480px',
                        shade: 0.6,
                        id: 'LAY_layuipro_address' ,//设定一个id，防止重复弹出,
//                        btn: ['取消', '保存为默认地址'],
                        moveType: 1 ,//拖拽模式，0或者1,
                        content: $("#dialog"),
                        success: function (layero) {
                            //弹框加载成功
                        },
                        yes:function () {
                            //点击取消事件
                            layer.close(addressOpenDialog);
                        },
                        btn2:function () {
                            orderVM.$validator.validateAll('form-address-add').then(function (result) {
                                if(result){
                                    var selected_pName='',selected_cName='',selected_coName='';
                                    orderVM.province.map(function (item) {
                                        if(item.code==orderVM.address.selected_p){
                                            selected_pName=item.name
                                        }
                                    });
                                    orderVM.city.data.map(function (item) {
                                        if(item.code==orderVM.address.selected_c){
                                            selected_cName=item.name
                                        }
                                    });
                                    if(orderVM.country.data.length !=0 ){
                                        orderVM.country.data.map(function (item) {
                                            if(item.code==orderVM.address.selected_co){
                                                selected_coName=item.name
                                            }
                                        });
                                    }
                                    var _data={
                                        recipientName:orderVM.address.name,
                                        recipientPhone:orderVM.address.phone,
                                        province:orderVM.address.selected_p,
                                        provinceDesc:selected_pName,
                                        city:orderVM.address.selected_c,
                                        cityDesc:selected_cName,
                                        recipientAddress:orderVM.address.recipientAddress,
                                        isDefault:1,
                                        status:0,
                                    };
                                    if(orderVM.country.data.length !=0){
                                        _data.country=orderVM.address.selected_co;
                                        _data.countryDesc=selected_coName;
                                    }
                                    $.ajax({
                                        url:'/userCenter/addAddressList',
                                        type:'post',
                                        data:_data,
                                        success: function(_data) {
                                            if(_data.success) {
                                                orderVM.addressList.map(function (item) {
                                                    item.isDefault = 0;
                                                })
                                                orderVM.addressList.push(_data.data);
                                                //将默认设置致空
                                                orderVM.recipientId = _data.data.id
                                                layer.closeAll();
                                            }
                                        }
                                    })
                                }
                            });
                            return false;
                        }
                    }
                    layui.use('layer',function() {
                        addressOpenDialog = layer.open(layer_type);
                    })
                    /*showAddress(t.currentTarget);*/
                },
                del_arress:function (t,id) {
                    var that = t.currentTarget;
                    var othis = $(that), method = othis.data('method');
                    var active = {
                        notice: function () {
                            layer.open({
                                type: 1,
                                title: "删除地址",//false不显示标题栏,
                                area: '350px;',
                                shade: 0.6,
                                id: 'LAY_layuipro_del',//设定一个id，防止重复弹出,
                                btn: ['确认', '取消'],
                                moveType: 1,//拖拽模式，0或者1,
                                content: '<div style="padding:30px 25px;font-size: 16px;color: #2a2a2a;">确认地址？</div>   ',
                                success: function (layero) {
                                    var btn = layero.find('.layui-layer-btn');
                                    btn.css('text-align', 'center');
                                    btn.find('.layui-layer-btn0').on('click', function () {
                                        $.ajax({
                                            url: '/userCenter/delAddressList',
                                            type: 'post',
                                            data: {id: id,status:1},
                                            success: function (_data) {
                                                if(_data.success){
                                                    var _arr = [];
                                                    basicMsgVM.addressList.forEach(function(item) {
                                                        if(item.id !== id){
                                                            _arr.push(item) ;
                                                        }
                                                    });
                                                    basicMsgVM.addressList = _arr;
                                                    _arr = [];
                                                }
                                            }
                                        });

                                    });
                                }
                            });
                        }
                    };
                    active[method] ? active[method].call(that, othis) : '';
                },
                edit_arress:function (t,id) {
                    var t = t.currentTarget,that=this;
                    axios.post('/userCenter/sectIdAddress',{id:id}).then(
                        function (data) {
                            if(data.data.success){
                                var _data = data.data.data;
                                that.name = _data.recipientName;
                                that.phone = _data.recipientPhone;
                                that.selected_p = _data.province;
//                                that.selected_p.name = _data.provinceDesc;
//                                that.selected_c.name = _data.cityDesc;
//                                that.selected_co.name = _data.countryDesc;
                                that.recipientAddress = _data.recipientAddress;
                                that.edit_open(t,id);
//                                if(_data.countryDesc != undefined){
//                                    that.selected_co.name = _data.countryDesc;
//                                }
                                axios.get('/region.json').then(
                                    function (data) {
                                        that.province = data.data.data;
                                    }
                                ).then(function () {
                                    that.selected_c = _data.city;
                                    that.tre_city();
                                }).then(function () {
                                    that.selected_co = _data.country;
                                    that.tre_country();
                                })
                            }
                        }
                    )
                },
                edit_open:function (t,id) {
                    var that = t;
                    var othis = $(that), method = othis.data('method');
                    var active = {
                        notice: function () {
                            layer.open({
                                type: 1,
                                title: "编辑地址",//false不显示标题栏,
                                area: '480px;',
                                shade: 0.6,
                                id: 'LAY_layuipro',//设定一个id，防止重复弹出,
                                btn: ['确认', '取消'],
                                moveType: 1,//拖拽模式，0或者1,
                                content: $("#edit_dialog"),
                                yes:function (index, layero) {
                                    var selected_pName='',selected_cName='',selected_coName='';
                                    basicMsgVM.province.map(function (item) {
                                        if(item.code==basicMsgVM.selected_p){
                                            selected_pName=item.name
                                        }
                                    });
                                    basicMsgVM.city.data.map(function (item) {
                                        if(item.code==basicMsgVM.selected_c){
                                            selected_cName=item.name
                                        }
                                    });
                                    if(basicMsgVM.country.data.length !=0 ){
                                        basicMsgVM.country.data.map(function (item) {
                                            if(item.code==basicMsgVM.selected_co){
                                                selected_coName=item.name
                                            }
                                        });
                                    }
                                    var _data = {
                                        recipientName:basicMsgVM.name,
                                        recipientPhone:basicMsgVM.phone,
                                        province:basicMsgVM.selected_p,
                                        provinceDesc:selected_pName,
                                        city:basicMsgVM.selected_c,
                                        cityDesc:selected_cName,
                                        recipientAddress:basicMsgVM.recipientAddress,
                                        id:id
                                    };
                                    if(basicMsgVM.country.data.length !=0){
                                        _data.country=basicMsgVM.selected_co;
                                        _data.countryDesc=selected_coName;
                                    }else{
                                        _data.country="";
                                        _data.countryDesc="";
                                    }
                                    basicMsgVM.validateBeforeSubmit(_data,'/userCenter/editAddressList');
                                },
                                success: function (layero) {
                                    var btn = layero.find('.layui-layer-btn');
                                    btn.css('text-align', 'center');
                                }
                            });
                        }
                    };
                    active[method] ? active[method].call(that, othis) : '';
                },
                set_default:function (id) {
                    var that = this;
                    axios.post('/userCenter/setdefault',{id:id}).then(
                        function (data) {
                            if(data.data.success){
                                that.addressList.map(function (item) {
                                    if(item.id == id){
                                        that.$set(item, "isDefault", 1);
                                    }else{
                                        that.$set(item, "isDefault", 0);
                                    }
                                });
                            }
                        }
                    )
                },
                personal:function () {
                    axios.get('/userCenter/userPersonal?'+new Date).then(
                        function (data) {
                            basicMsgVM.personalList = data.data.data;
                            basicMsgVM.deit_one = 2;
                            basicMsgVM.isDis = false;
                            basicMsgVM.codeHtml = '获取验证码';
                            basicMsgVM.code=null;
                            clearInterval(basicMsgVM.Td);
                        }
                    );
                },
                edit_person:function (str) {
                    var data={};
                    if(str=="form-2"){
                        data={nickname:this.personalList.nickname, qq:this.personalList.qq,tel:this.personalList.tel};
                    }else if(str=="form-2-e"){
                        data={email:(this.personalList.email||"")};
                    }else if(str=="form-2-p"){
                        data={tel:this.personalList.tel};
                    }
                    axios.post('/userCenter/editPersonal',data).then(
                        function (data) {
                            if(data.data.success){
                                if(str=="form-2"){
                                    basicMsgVM.deitName=true;
                                    $("#userName_nav").text(basicMsgVM.personalList.nickname);
                                }else if(str=="form-2-e"){
                                    basicMsgVM.deitEmail=true;
                                }else if(str=="form-2-p"){
                                    basicMsgVM.deitPhone=true;
                                }
                            }
                        }
                    );
                },
                passportCode: function (_str) {
                    var url='',_data={},that=this;
                    if(_str == 'form-3-p'){
                        url='/user/forgetPwdCode';
                        _data={passport:this.personalList.tel};
                    }else if(_str == 'form-3-e'){
                        url='/user/getPwdEmailCode';
                        _data={email:this.personalList.email,code:"reg"};
                    }
                    var layer = layui.layer;
                        function countDown(that, num) {
                            var num = num;
                            function TimeFn() {
                                if (num == 0) {
                                    basicMsgVM.isDis = false;
                                    basicMsgVM.codeHtml = "获取验证码";
                                    num = 60;
                                    clearInterval(basicMsgVM.Td);
                                    return;
                                } else {
                                    num--;
                                    basicMsgVM.codeHtml = num + 's';
                                    basicMsgVM.isDis = true;
                                }
                            }
                            basicMsgVM.Td = setInterval(function () {
                                TimeFn()
                            }, 1000)
                        };
                        axios.post(url, _data).then(
                            function (res) {
                                if (res.data.success) {
                                    layui.use('layer', function () {
                                        var layer = layui.layer;
                                        layui.use('layer', function () {
                                            var layer = layui.layer;
                                            layer.msg('验证码发送成功',{icon:1});
                                        });
                                    });
                                    countDown(this, 60)
                                } else {
                                    layui.use('layer', function () {
                                        var layer = layui.layer;
                                        layui.use('layer', function () {
                                            var layer = layui.layer;
                                            layer.msg( res.data.message);
                                        });
                                    });
                                    countDown(this, 0)
                                }
                            }, function (errRespone) {
                                alert(errRespone)
                            });
                },
                getCodeTrue:function (url,_userData) {
                  axios.post(url,_userData).then(
                      function (data) {
                          if(data.data.success){
                              basicMsgVM.deit_one=3;
                              layer.msg("验证成功",{icon:1});
                              basicMsgVM.codeHtml = "获取验证码";
                              clearInterval(basicMsgVM.Td);
                              basicMsgVM.errors.clear('form-4');
                              basicMsgVM.userData={

                              };
                          }else{
//                              layer.msg(data.data.messages);
                          }
                  })
                },
                upDataPW:function(){
                    axios.post('/userCenter/editPersonal',{pwd:basicMsgVM.passWordes}).then(
                        function (data) {
                            if(data.data.success){
                                basicMsgVM.deit_one=2;
                                layer.msg("修改成功",{icon:1});
                                basicMsgVM.passWordes="";
                                basicMsgVM.password="";
                                clearInterval(basicMsgVM.Td);
                                basicMsgVM.isDis = false;
                                basicMsgVM.codeHtml = '获取验证码';
                                basicMsgVM.errors.clear('form-3');
                                basicMsgVM.errors.clear('form-4');
                            }else{
                                layer.msg("修改失败");
                            }
                        }
                    )
                },
                color_show:function (t,str) {
                    var t = t.currentTarget;
                    if(str == true){
                        $(t).find('td').find('.hide').css({display:"block",float:'right'});
                    }else{
                        $(t).find('td').find('.hide').css({display:"none"});
                    }
                },
                validateBeforeSubmit:function (_data,_url) {
                    this.$validator.validateAll().then(function () {
                        $.ajax({
                            url:_url,
                            type:'post',
                            data:_data,
                            success: function(_data) {
                                if(_data.success) {
                                    basicMsgVM.address_List();
                                    layer.closeAll();
                                }
                            }
                        });
                    })
                },
                validateForm:function (scope) {
                    this.$validator.validateAll(scope).then(function (result) {
                        if(result){
//                            if(scope == 'form-comp'){
//                                basicMsgVM.compMsg.blicensenum =basicMsgVM.companyMsg.blicensenum;
//                                basicMsgVM.compMsg.type = basicMsgVM.companyMsg.type;
//                                basicMsgVM.compMsg.id = basicMsgVM.companyMsg.id;
//                                axios.post('/userCenter/userComMsg',basicMsgVM.compMsg).then(
//                                    function (data) {
//                                        if(data.data.success){
//                                            window.location.reload();
//                                        }
//                                    }
//                                )
//                            }else if(scope == 'form-perpson'){
//                                basicMsgVM.compMsg.realname = basicMsgVM.companyMsg.realname;
//                                basicMsgVM.compMsg.idcard = basicMsgVM.companyMsg.idcard;
//                                basicMsgVM.compMsg.type = basicMsgVM.companyMsg.type;
//                                basicMsgVM.compMsg.id = basicMsgVM.companyMsg.id;
//                                axios.post('/userCenter/userComMsg',basicMsgVM.compMsg).then(
//                                    function (data) {
//                                        if(data.data.success){
//                                            window.location.reload();
//                                        }
//                                    }
//                                )
//                            }else
                            if(scope == 'form-2'){
                                basicMsgVM.edit_person("form-2");
                            }else if(scope == 'form-2-e'){
                                basicMsgVM.edit_person("form-2-e");
                            }else if(scope == 'form-2-p'){
                                basicMsgVM.edit_person("form-2-p");
                            }else if(scope == 'form-3-p'){
                                var url = '/user/getCodeTrue';
                                var _userData = {passport:basicMsgVM.personalList.tel,code:basicMsgVM.userData.code};
                                basicMsgVM.getCodeTrue(url,_userData);
                            } else if(scope == 'form-3-e'){
                                var url = '/user/getCodeTrueEmal';
                                var _userData = {email:basicMsgVM.personalList.email,code:basicMsgVM.userData.email};
                                basicMsgVM.getCodeTrue(url,_userData);
                            }else if(scope == 'form-3-ps'){
                                var url = '/user/getPassWordTrue';
                                var _userData = {code:basicMsgVM.userData.oPassword}
                                basicMsgVM.getCodeTrue(url,_userData);
                            }else if(scope == 'form-4'){
                                basicMsgVM.upDataPW();
                            }else if(scope == 'form-address-add'){
                                basicMsgVM.address_add();
                            }
                        }
                    })
                },
                address_add:function () {
                    var selected_pName='',selected_cName='',selected_coName='';
                    basicMsgVM.province.map(function (item) {
                        if(item.code==basicMsgVM.address.selected_p){
                            selected_pName=item.name
                        }
                    });
                    basicMsgVM.city.data.map(function (item) {
                        if(item.code==basicMsgVM.address.selected_c){
                            selected_cName=item.name
                        }
                    });
                    if(basicMsgVM.country.data.length !=0 ){
                        basicMsgVM.country.data.map(function (item) {
                            if(item.code==basicMsgVM.address.selected_co){
                                selected_coName=item.name
                            }
                        });
                    }
                    var _data={
                        recipientName:basicMsgVM.address.name,
                        recipientPhone:basicMsgVM.address.phone,
                        province:basicMsgVM.address.selected_p,
                        provinceDesc:selected_pName,
                        city:basicMsgVM.address.selected_c,
                        cityDesc:selected_cName,
                        recipientAddress:basicMsgVM.address.recipientAddress,
                        isDefault:1,
                        status:0,
                    };
                    if(basicMsgVM.country.data.length !=0){
                        _data.country=basicMsgVM.address.selected_co;
                        _data.countryDesc=selected_coName;
                    }
                    $.ajax({
                        url:'/userCenter/addAddressList',
                        type:'post',
                        data:_data,
                        success: function(_data) {
                            if(_data.success) {
                                basicMsgVM.address_List();
                                layer.closeAll();
                            }
                        }
                    })
                },
                close_open:function () {
                    layer.closeAll();
                    basicMsgVM.errors.clear('form-address-add');
                },
            }
        });

        var passWordes = {
            messages: {
                en: function en(field, args) {
                    return args + '两次输入的密码不一致';
                }
            },
            validate: function validate(value, args) {
                return value == basicMsgVM.password;
            }
        };
        VeeValidate.Validator.extend('passWordes', passWordes);
//        var active = {
//            notice: function () {
//                var is_true = false;
//                basicMsgVM.address={};
//                layer.open({
//                    type: 1,
//                    title: "新增收件地址",//false不显示标题栏,
//                    area: ['680px','600px'],
//                    shade: 0.6,
//                    id: 'LAY_layuipro_id',//设定一个id，防止重复弹出,
//                    moveType: 1 ,//拖拽模式，0或者1,
//                    content: $("#dialog"),
//                    success: function (layero) {
//                        basicMsgVM.errors.clear('form-address-add');
//                    }
//                });
//            }
//        };
//        function showAddress(t) {
//            var that = t;
//            var othis = $(that), method = othis.data('method');
//            active[method] ? active[method].call(that, othis) : '';
//        }
    })
</script>